doctype html
html
    include includes/head.pug
    body.logged_in
        header
            h1= header
            h3= displayName
            h4
                a(href='/settings') settings
            h4
                a(href='/logout')  logout
        aside
            div#chatList
                h3 Friends
                ul
                    li(v-for="(friend, index) in friends" v-cloak)
                        div.item-content(v-bind:class="{ active: currRoom[0] == friend[1]}")
                            span(v-on:click='selectDm(index)' v-cloak) {{ friend[4] }}
                            span
                                span(v-show='!friend[3]' v-cloak) {{ friend[2] }}
                                span.material-icons.user-settings-icon(v-on:click='toggleMenu(index,true)' v-cloak) keyboard_arrow_up
                        div.friend-menu(v-bind:class="[friend[5] ? 'dropdown' : dropup(index)]")
                            p {{ friend[0] }}
                            button(v-on:click='removeFriend(index)') remove
                h3 Rooms
                ul
                    li.item-content(v-for="(room, index) in rooms" v-on:click='selectChat(index)' v-bind:class="{ active: currRoom[0] == room[0]}")
                        span(v-cloak) {{room[0]}}
                        span
                            span(v-show='!room[2]' v-cloak) {{room[1]}}
            form(id="addFriendForm" onsubmit="return false" v-on:submit="sendFriendRequest")
                input(type="text" v-model="friend" placeholder="username")
                input(type="submit" value="add")
            div#friend_requests
                h3(v-bind:class="{'hidden': frh(ifr)}") Friend requests
                ul
                    li(v-for="(request,index) in ifr")
                        span {{request}}
                        button(v-on:click='confirmFriendRequest(index)') add
                h3(v-bind:class="{'hidden': frh(sfr)}") Pending friend requests
                ul
                    li(v-for="(request,index) in sfr")
                        span {{request}}
                        button(v-on:click="cfr(index)") cancel
        section.chatWindow
            div#chatMessages.chatMessages
                    div(v-for="(message, index) in messages" :class='message[1]' class="message" v-cloak)
                        img(v-bind:src="imgSrc(message[2])" alt="Profile Picture" :class='message[1]')
                        span {{message[0]}}
            form(id="messageForm" onsubmit="return false" v-on:submit="sendMessage" class="chat_input_form")
                input(type="text" v-model="message" class="text_input" autofocus)
                input(type="submit" value="send" class="button")
        include includes/bottom.pug
